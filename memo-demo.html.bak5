<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chief AI - Memo Generator Demo</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
    
    * {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }
    
    body {
      cursor: pointer;
    }
    
    .screen {
      display: none;
      min-height: 100vh;
      animation: fadeIn 0.3s ease-in;
    }
    
    .screen.active {
      display: block;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .loading-spinner {
      border: 3px solid rgba(243, 244, 246, 0.3);
      border-top: 3px solid #3b82f6;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .step-completed {
      color: #10b981;
    }
    
    .step-in-progress {
      color: #3b82f6;
    }
    
    .step-pending {
      color: #9ca3af;
    }
    
    .nav-hint {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 8px 12px;
      border-radius: 6px;
      font-size: 12px;
      pointer-events: none;
      animation: pulse-hint 2s ease-in-out infinite;
    }
    
    @keyframes pulse-hint {
      0%, 100% { opacity: 0.7; }
      50% { opacity: 1; }
    }
    
    /* Responsive breakpoints optimized for 1440px desktop */
    @media (min-width: 1440px) {
      .max-w-4xl {
        max-width: 1280px;
      }
      .max-w-5xl {
        max-width: 1400px;
      }
      .px-6 {
        padding-left: 2rem;
        padding-right: 2rem;
      }
      .py-12 {
        padding-top: 4rem;
        padding-bottom: 4rem;
      }
    }
    
    @media (max-width: 1439px) and (min-width: 1024px) {
      .max-w-4xl {
        max-width: 896px;
      }
      .max-w-5xl {
        max-width: 1024px;
      }
    }
    
    @media (max-width: 1023px) {
      .max-w-4xl,
      .max-w-5xl {
        max-width: 100%;
        padding-left: 1rem;
        padding-right: 1rem;
      }
    }
  </style>
</head>
<body class="bg-gray-50">
  
  <!-- Navigation Hint -->
  <div class="nav-hint">Click anywhere to advance →</div>
  
  <!-- Screen 1: Event Detail -->
  <div id="screen1" class="screen active">
    <div class="max-w-4xl mx-auto px-6 py-12">
      <!-- Header -->
      <div class="flex items-center justify-between mb-8">
        <h1 class="text-2xl font-bold text-gray-900">Calendar</h1>
        <div class="flex items-center space-x-2">
          <div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center">
            <span class="text-white font-bold text-sm">C</span>
          </div>
          <span class="text-sm font-semibold text-gray-700">Chief AI</span>
        </div>
      </div>
      
      <!-- Event Card -->
      <div class="bg-white rounded-xl shadow-lg p-8">
        <h2 id="event-title" class="text-3xl font-bold text-gray-900 mb-6">Q4 Budget Discussion with Denver Public Schools</h2>
        
        <!-- Date/Time/Location -->
        <div class="space-y-3 mb-6">
          <div class="flex items-center text-gray-600">
            <svg class="w-5 h-5 mr-2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
            </svg>
            <span id="event-datetime" class="font-medium">Friday, Nov 15 · 2:00 PM - 3:00 PM</span>
          </div>
          <div class="flex items-center text-gray-600">
            <svg class="w-5 h-5 mr-2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
            <span id="event-location">Mayor's Conference Room</span>
          </div>
        </div>
        
        <!-- Attendees Section -->
        <div class="mb-6">
          <h3 class="text-sm font-semibold text-gray-700 mb-4">Attendees</h3>
          <div class="space-y-4">
            <div class="flex items-start space-x-3">
              <div class="w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center flex-shrink-0">
                <span class="text-white font-semibold text-sm">AJ</span>
              </div>
                <div class="flex-1">
                <p class="font-semibold text-gray-900">Dr. Alex Johnson</p>
                <p class="text-sm text-gray-600">Superintendent</p>
                <p class="text-sm text-gray-500">Denver Public Schools</p>
              </div>
            </div>
            <div class="flex items-start space-x-3">
              <div class="w-12 h-12 bg-purple-500 rounded-full flex items-center justify-center flex-shrink-0">
                <span class="text-white font-semibold text-sm">MR</span>
              </div>
              <div class="flex-1">
                    <p class="font-semibold text-gray-900">Maria Rodriguez</p>
                <p class="text-sm text-gray-600">Chief Financial Officer</p>
                <p class="text-sm text-gray-500">Denver Public Schools</p>
              </div>
              </div>
            </div>
          </div>
          
        <!-- Description -->
        <div class="mb-8">
          <p class="text-gray-600 leading-relaxed">
            Quarterly budget review and discussion of upcoming initiatives for Denver Public Schools. Focus on capital improvements and staffing allocations.
          </p>
        </div>
        
        <!-- Generate Memo Button -->
        <button class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-4 px-6 rounded-lg transition-colors duration-200 flex items-center justify-center shadow-md">
          <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
          </svg>
          Generate Memo
        </button>
      </div>
    </div>
  </div>
  
  <!-- Screen 2: Loading State -->
  <div id="screen2" class="screen" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
    <div class="min-h-screen flex items-center justify-center px-6">
      <div class="text-center text-white max-w-md">
        <!-- Spinner -->
        <div class="mb-8 flex justify-center">
          <div class="loading-spinner"></div>
        </div>
        
        <!-- Title -->
        <h2 class="text-2xl font-bold mb-2">Generating your memo...</h2>
        <p class="text-blue-100 mb-8">This usually takes 5-10 seconds</p>
        
        <!-- Progress Steps -->
        <div class="space-y-3 text-left bg-white rounded-lg p-6 max-w-md mx-auto">
          <!-- Step 1: Completed -->
          <div class="flex items-center gap-3 text-gray-700">
            <svg class="w-5 h-5 text-green-600 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
            </svg>
            <div class="flex-1">
              <div class="font-semibold">Found 2 attendee profiles</div>
              <div class="text-sm text-gray-500">Dr. Johnson (12 interactions), Rodriguez (8 interactions)</div>
            </div>
          </div>

          <!-- Step 2: Completed -->
          <div class="flex items-center gap-3 text-gray-700">
            <svg class="w-5 h-5 text-green-600 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
            </svg>
            <div class="flex-1">
              <div class="font-semibold">Retrieved 3 recent news articles</div>
              <div class="text-sm text-gray-500">Denver Post, Chalkbeat Colorado, Denver Gazette</div>
            </div>
          </div>

          <!-- Step 3: In Progress -->
          <div class="flex items-center gap-3 text-blue-600">
            <svg class="w-5 h-5 flex-shrink-0 animate-pulse" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd" />
            </svg>
            <div class="flex-1">
              <div class="font-semibold">Analyzing 23 past interactions</div>
              <div class="text-sm text-blue-500">Identifying patterns and key topics...</div>
            </div>
          </div>

          <!-- Step 4: Pending -->
          <div class="flex items-center gap-3 text-gray-400">
            <svg class="w-5 h-5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 20 20">
              <circle cx="10" cy="10" r="8" stroke-width="2" />
            </svg>
            <div class="flex-1">
              <div class="font-semibold">Generating draft memo</div>
              <div class="text-sm text-gray-400">Applying template and synthesizing insights...</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Screen 3: Generated Memo -->
  <div id="screen3" class="screen">
    <div class="max-w-5xl mx-auto px-6 py-8">
        <!-- Header -->
      <div class="flex items-center justify-between mb-8">
        <h1 class="text-2xl font-bold text-gray-900">Meeting Memo</h1>
        <div class="flex items-center space-x-2">
          <button class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
            Export
          </button>
          <button class="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors">
            Add to Calendar
          </button>
            </div>
          </div>
      
      <!-- Toolbar (fake) -->
      <div class="bg-gray-50 border border-gray-200 rounded-t-lg p-2 mb-0 flex items-center space-x-2">
        <button class="p-2 hover:bg-gray-200 rounded text-gray-600">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
          </svg>
        </button>
        <button class="p-2 hover:bg-gray-200 rounded text-gray-600">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
        <div class="flex-1"></div>
        <span class="text-xs text-gray-500">Edit mode</span>
          </div>
      
      <!-- Memo Content -->
      <div class="bg-white border border-gray-200 border-t-0 rounded-b-lg p-8 prose prose-lg max-w-none">
        <!-- Meeting Title -->
        <h1 class="text-4xl font-bold text-gray-900 mb-2">Q4 Budget Discussion with Denver Public Schools</h1>
        <div class="text-gray-600 mb-8 space-y-1">
          <p>Friday, Nov 15 · 2:00 PM - 3:00 PM</p>
          <p>Mayor's Conference Room</p>
        </div>
        
        <!-- Meeting Context Callout -->
        <div class="bg-blue-50 border-l-4 border-blue-500 rounded-r-lg p-6 mb-8">
          <div class="flex items-center flex-wrap gap-2 mb-2">
            <h2 class="text-lg font-semibold text-gray-900">Meeting Context</h2>
            <div class="inline-flex items-center gap-2">
              <span class="text-xs px-2 py-1 bg-green-100 text-green-800 rounded-full font-semibold flex items-center gap-1">
                <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                </svg>
                High confidence
              </span>
              <span class="text-xs text-gray-500">Based on 5 data sources</span>
            </div>
          </div>
          <p class="text-gray-700 leading-relaxed">
            Loading...
          </p>
        </div>
        

        <!-- Relationship History Timeline -->
        <div class="bg-gradient-to-r from-gray-50 to-white border border-gray-200 rounded-lg p-6 mb-8">
          <h2 class="text-2xl font-bold text-gray-900 mb-6">Relationship History</h2>

          <div class="relative">
            <!-- Vertical timeline line -->
            <div class="absolute left-20 top-0 bottom-0 w-0.5 bg-gray-300"></div>

            <!-- Timeline items container -->
            <div class="space-y-6">
              <!-- Event 1: 77 days ago - Call -->
              <div class="flex items-start gap-4">
                <!-- Time label -->
                <div class="w-16 text-sm text-gray-500 text-right pt-1.5">77 days</div>

                <!-- Dot indicator -->
                <div class="w-3 h-3 rounded-full bg-blue-500 mt-2 relative z-10 flex-shrink-0"></div>

                <!-- Event card -->
                <div class="flex-1 bg-white border border-gray-200 rounded-lg p-4 shadow-sm">
                  <div class="flex items-start justify-between mb-1">
                    <div class="text-sm font-semibold text-gray-900">Call with Dr. Johnson</div>
                    <span class="text-xs text-gray-500 bg-blue-50 px-2 py-0.5 rounded">Call</span>
                  </div>
                  <div class="text-xs text-gray-600">Summer program outcomes - positive feedback on city partnership programs</div>
                </div>
              </div>

              <!-- Event 2: 53 days ago - Meeting -->
              <div class="flex items-start gap-4">
                <!-- Time label -->
                <div class="w-16 text-sm text-gray-500 text-right pt-1.5">53 days</div>

                <!-- Dot indicator -->
                <div class="w-3 h-3 rounded-full bg-purple-500 mt-2 relative z-10 flex-shrink-0"></div>

                <!-- Event card -->
                <div class="flex-1 bg-white border border-gray-200 rounded-lg p-4 shadow-sm">
                  <div class="flex items-start justify-between mb-1">
                    <div class="text-sm font-semibold text-gray-900">Meeting with Dr. Johnson, Maria Rodriguez</div>
                    <span class="text-xs text-gray-500 bg-purple-50 px-2 py-0.5 rounded">Meeting</span>
                  </div>
                  <div class="text-xs text-gray-600">Q3 Budget Review - Discussed infrastructure needs and staffing challenges</div>
                </div>
              </div>

              <!-- Event 3: 28 days ago - Workshop -->
              <div class="flex items-start gap-4">
                <!-- Time label -->
                <div class="w-16 text-sm text-gray-500 text-right pt-1.5">28 days</div>

                <!-- Dot indicator -->
                <div class="w-3 h-3 rounded-full bg-green-500 mt-2 relative z-10 flex-shrink-0"></div>

                <!-- Event card -->
                <div class="flex-1 bg-white border border-gray-200 rounded-lg p-4 shadow-sm">
                  <div class="flex items-start justify-between mb-1">
                    <div class="text-sm font-semibold text-gray-900">Workshop with Maria Rodriguez</div>
                    <span class="text-xs text-gray-500 bg-green-50 px-2 py-0.5 rounded">Workshop</span>
                  </div>
                  <div class="text-xs text-gray-600">City budget workshop - Asked detailed questions about multi-year funding commitments</div>
                </div>
              </div>

              <!-- Event 4: 10 days ago - Email (recent, with ring) -->
              <div class="flex items-start gap-4">
                <!-- Time label -->
                <div class="w-16 text-sm text-gray-500 text-right pt-1.5">10 days</div>

                <!-- Dot indicator with ring effect -->
                <div class="w-3 h-3 rounded-full bg-green-500 ring-2 ring-green-200 mt-2 relative z-10 flex-shrink-0"></div>

                <!-- Event card -->
                <div class="flex-1 bg-white border border-gray-200 rounded-lg p-4 shadow-sm">
                  <div class="flex items-start justify-between mb-1">
                    <div class="text-sm font-semibold text-gray-900">Email from Dr. Johnson</div>
                    <span class="text-xs text-gray-500 bg-green-50 px-2 py-0.5 rounded">Email</span>
                  </div>
                  <div class="text-xs text-gray-600">Teacher retention proposal - Expressed interest in partnership opportunities</div>
                </div>
              </div>

              <!-- Event 5: Today - Current meeting (special styling) -->
              <div class="flex items-start gap-4">
                <!-- Time label -->
                <div class="w-16 text-sm text-gray-500 text-right pt-1.5">Today</div>

                <!-- Dot indicator with animated pulse ring -->
                <div class="w-3 h-3 rounded-full bg-blue-500 ring-4 ring-blue-200 animate-pulse mt-2 relative z-10 flex-shrink-0"></div>

                <!-- Event card with blue background -->
                <div class="flex-1 bg-blue-50 border border-blue-200 rounded-lg p-4 shadow-sm">
                  <div class="flex items-start justify-between mb-1">
                    <div class="text-sm font-semibold text-blue-900">Meeting with Dr. Johnson, Maria Rodriguez</div>
                    <span class="text-xs text-blue-700 bg-blue-100 px-2 py-0.5 rounded">Meeting</span>
                  </div>
                  <div class="text-xs text-blue-800">Q4 Budget Discussion</div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- Attendee Backgrounds -->
        <div class="mb-8">
          <div class="flex items-center flex-wrap gap-2 mb-4">
            <h2 class="text-2xl font-bold text-gray-900">Attendee Backgrounds</h2>
            <div class="inline-flex items-center gap-2">
              <span class="text-xs px-2 py-1 bg-green-100 text-green-800 rounded-full font-semibold flex items-center gap-1">
                <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                </svg>
                High confidence
              </span>
              <span class="text-xs text-gray-500">Based on 12 data points</span>
            </div>
          </div>
          <div id="attendee-backgrounds">
            <!-- Dynamically populated -->
          </div>
        </div>
        
        <!-- Key Topics -->
        <div class="mb-8">
          <div class="flex items-center flex-wrap gap-2 mb-4">
            <h2 class="text-2xl font-bold text-gray-900">Key Topics</h2>
            <div class="inline-flex items-center gap-2">
              <span class="text-xs px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full font-semibold flex items-center gap-1">
                <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                </svg>
                Medium confidence
              </span>
              <span class="text-xs text-gray-500">Inferred from description + recent news</span>
            </div>
          </div>
          <ul id="key-topics" class="space-y-2 list-none">
            <!-- Dynamically populated -->
          </ul>
        </div>
        
        <!-- Suggested Talking Points -->
        <div class="mb-8">
          <div class="flex items-center flex-wrap gap-2 mb-4">
            <h2 class="text-2xl font-bold text-gray-900">Suggested Talking Points</h2>
            <div class="inline-flex items-center gap-2">
              <span class="text-xs px-2 py-1 bg-green-100 text-green-800 rounded-full font-semibold flex items-center gap-1">
                <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                </svg>
                High confidence
              </span>
              <span class="text-xs text-gray-500">Based on 6 recent interactions</span>
            </div>
          </div>
          <div id="talking-points" class="space-y-4">
            <!-- Dynamically populated -->
          </div>
        </div>
        
        <!-- Recent Developments -->
        <div class="mb-8">
          <div class="flex items-center flex-wrap gap-2 mb-4">
            <h2 class="text-2xl font-bold text-gray-900">Recent Developments</h2>
            <div class="inline-flex items-center gap-2">
              <span class="text-xs px-2 py-1 bg-blue-100 text-blue-800 rounded-full font-semibold flex items-center gap-1">
                <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                </svg>
                Verified
              </span>
              <span class="text-xs text-gray-500">3 sources confirmed</span>
            </div>
          </div>
          <div id="recent-developments" class="space-y-4">
            <!-- Dynamically populated -->
          </div>
        </div>
        
        <!-- Relationship History -->
        <div class="mb-8">
          <h2 class="text-2xl font-bold text-gray-900 mb-4">Relationship History</h2>
          <div id="relationship-history" class="bg-gray-50 border-l-4 border-gray-400 rounded-r-lg p-6">
            <p class="text-gray-700 leading-relaxed">Loading...</p>
          </div>
        </div>
        
        <!-- Metadata Footer -->
        <div class="border-t border-gray-200 pt-6 mt-8 space-y-4">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="text-sm">
              <p class="font-semibold text-gray-700 mb-2">Data Sources & Confidence</p>
              <div class="space-y-1">
                <div class="flex items-center justify-between">
                  <span class="text-gray-600">Event calendar</span>
                  <span class="text-xs px-2 py-1 bg-green-100 text-green-800 rounded-full font-semibold">High</span>
                </div>
                <div class="flex items-center justify-between">
                  <span class="text-gray-600">Contact profiles</span>
                  <span class="text-xs px-2 py-1 bg-green-100 text-green-800 rounded-full font-semibold">High</span>
                </div>
                <div class="flex items-center justify-between">
                  <span class="text-gray-600">Organization database</span>
                  <span class="text-xs px-2 py-1 bg-green-100 text-green-800 rounded-full font-semibold">High</span>
                </div>
                <div class="flex items-center justify-between">
                  <span class="text-gray-600">News aggregator</span>
                  <span class="text-xs px-2 py-1 bg-blue-100 text-blue-800 rounded-full font-semibold">Verified</span>
                </div>
                <div class="flex items-center justify-between">
                  <span class="text-gray-600">Interaction history</span>
                  <span class="text-xs px-2 py-1 bg-green-100 text-green-800 rounded-full font-semibold">High</span>
                </div>
              </div>
            </div>
            <div class="text-sm space-y-3">
              <div>
                <p class="font-semibold text-gray-700 mb-1">Last Updated</p>
                <p id="last-updated" class="text-gray-600">Loading...</p>
              </div>
              <div>
                <p class="font-semibold text-gray-700 mb-1">Data Freshness</p>
                <div class="flex items-center gap-2">
                  <div class="flex-1 bg-gray-200 rounded-full h-2">
                    <div class="bg-green-500 h-2 rounded-full" style="width: 95%"></div>
                  </div>
                  <span class="text-xs text-gray-600">95% current</span>
                </div>
                <p class="text-xs text-gray-500 mt-1">All sources updated within 24 hours</p>
              </div>
              <div>
                <p class="font-semibold text-gray-700 mb-1">Overall Confidence</p>
                <span id="confidence" class="px-3 py-1 bg-gray-100 text-gray-600 text-xs font-semibold rounded-full">Loading...</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <script>
    // ============================================================================
    // MEMO GENERATOR (JavaScript version for browser)
    // ============================================================================
    
    const mockEvent = {
      id: 'evt_2025_q4_budget_dps',
      title: 'Q4 Budget Discussion with Denver Public Schools',
      datetime: '2025-11-15T14:00:00-07:00',
      location: "Mayor's Conference Room",
      description: 'Quarterly budget review and discussion of upcoming initiatives for Denver Public Schools. Focus on capital improvements and staffing allocations.',
      meetingType: 'external',
      attendees: [
        {
          name: 'Dr. Alex Johnson',
          title: 'Superintendent',
          organization: 'Denver Public Schools',
          profileId: 'prof_alex_johnson'
        },
        {
          name: 'Maria Rodriguez',
          title: 'Chief Financial Officer',
          organization: 'Denver Public Schools',
          profileId: 'prof_maria_rodriguez'
        }
      ]
    };
    
    const mockProfiles = [
      {
        id: 'prof_alex_johnson',
        name: 'Dr. Alex Johnson',
        title: 'Superintendent',
        organization: 'Denver Public Schools',
        bio: 'Dr. Johnson has served as Superintendent of Denver Public Schools since 2021, bringing over 20 years of educational leadership experience. Previously served as Deputy Superintendent in Seattle Public Schools, where she led initiatives that improved graduation rates by 15% over three years. Known for data-driven decision making and collaborative leadership style.',
        recentInteractions: [
          {
            date: '2025-10-28',
            type: 'email',
            summary: 'Follow-up on teacher retention program proposal. Expressed interest in exploring partnership <span class="bg-green-50 px-1 py-0.5 rounded">opportunities</span>.'
          },
          {
            date: '2025-09-15',
            type: 'meeting',
            summary: 'Q3 budget review meeting. Discussed infrastructure needs and staffing challenges. Dr. Johnson emphasized need for sustainable funding solutions.'
          },
          {
            date: '2025-08-22',
            type: 'call',
            summary: 'Brief call regarding summer program outcomes. Positive feedback on city partnership programs.'
          }
        ],
        priorities: [
          'Teacher retention and compensation',
          'Infrastructure improvements in underserved schools',
          'Expanding after-school programs',
          'Addressing achievement gaps'
        ],
        relationshipNotes: 'Prefers detailed data and concrete proposals. Values transparency and long-term planning. Responds well to collaborative approaches. Best reached via email for initial contact, prefers in-person for substantive discussions.'
      },
      {
        id: 'prof_maria_rodriguez',
        name: 'Maria Rodriguez',
        title: 'Chief Financial Officer',
        organization: 'Denver Public Schools',
        bio: 'Maria Rodriguez joined DPS in 2019 as CFO, bringing extensive experience in public sector finance from her previous role as Finance Director for the City of Aurora. She has a Master\'s in Public Administration and is known for her meticulous budget analysis and ability to find creative funding solutions. Strong advocate for transparency in public spending.',
        recentInteractions: [
          {
            date: '2025-11-05',
            type: 'email',
            summary: 'Requested clarification on capital improvement timeline. Concerned about Q4 budget constraints.'
          },
          {
            date: '2025-10-10',
            type: 'meeting',
            summary: 'Attended city budget workshop. Asked detailed questions about multi-year funding commitments.'
          },
          {
            date: '2025-09-20',
            type: 'email',
            summary: 'Shared updated enrollment projections affecting budget planning.'
          }
        ],
        priorities: [
          'Maintaining fiscal responsibility',
          'Multi-year budget planning',
          'Capital improvement funding',
          'Staffing cost management'
        ],
        relationshipNotes: 'Detail-oriented and data-focused. Appreciates early communication about budget implications. Prefers written documentation before meetings. Very responsive to email, typically replies within 24 hours.'
      }
    ];
    
    const mockOrganization = {
      name: 'Denver Public Schools',
      description: 'Denver Public Schools is the largest school district in Colorado, serving over 90,000 students across 207 schools. The district serves a diverse student population and is committed to providing equitable educational opportunities. Recent focus areas include addressing achievement gaps, improving infrastructure, and supporting teacher retention.',
      recentNews: [
        {
          headline: 'DPS Announces $50M Infrastructure Improvement Plan',
          date: '2025-11-01',
          source: 'Denver Post',
          summary: 'Denver Public Schools unveiled a comprehensive plan to address aging infrastructure across 15 schools, with focus on HVAC systems and accessibility improvements. Funding includes $30M from district reserves and $20M in proposed city partnership.'
        },
        {
          headline: 'Teacher Retention Rates Improve Following Compensation Increases',
          date: '2025-10-18',
          source: 'Chalkbeat Colorado',
          summary: 'Early data shows teacher retention improved by 8% following implementation of new compensation structure. Superintendent Johnson credits collaborative approach with teacher unions and city support for the positive trend.'
        },
        {
          headline: 'DPS Seeks City Support for Expanded After-School Programs',
          date: '2025-10-05',
          source: 'Denver Gazette',
          summary: 'District leadership is requesting additional city funding to expand after-school programming to 20 additional schools, particularly in underserved neighborhoods. Proposal includes partnership with city recreation centers.'
        }
      ],
      keyInitiatives: [
        'Infrastructure modernization (2025-2027)',
        'Teacher retention and compensation program',
        'Expansion of after-school and enrichment programs',
        'Achievement gap reduction initiatives',
        'Technology infrastructure upgrades'
      ],
      relationship: 'constituent'
    };
    
    function formatDate(dateString) {
      const date = new Date(dateString);
      const options = {
        weekday: 'long',
        year: 'numeric',
        month: 'long',
        day: 'numeric',
        hour: 'numeric',
        minute: '2-digit',
        timeZoneName: 'short'
      };
      return date.toLocaleDateString('en-US', options);
    }
    
    function formatDateShort(dateString) {
      const date = new Date(dateString);
      const options = {
        month: 'short',
        day: 'numeric',
        year: 'numeric'
      };
      return date.toLocaleDateString('en-US', options);
    }
    
    function formatTime(dateString) {
      const date = new Date(dateString);
      const endDate = new Date(date.getTime() + 60 * 60 * 1000); // Add 1 hour for end time
      const options = {
        weekday: 'long',
        month: 'short',
        day: 'numeric',
        hour: 'numeric',
        minute: '2-digit',
        hour12: true
      };
      const startStr = date.toLocaleDateString('en-US', options);
      const endStr = endDate.toLocaleDateString('en-US', options);
      const datePart = startStr.split(', ')[0];
      const startTime = startStr.split(', ')[1] || '';
      const endTime = endStr.split(', ')[1] || '';
      return `${datePart}, ${startTime} - ${endTime}`;
    }
    
    function daysAgo(dateString) {
      const date = new Date(dateString);
      const today = new Date();
      const diffTime = Math.abs(today.getTime() - date.getTime());
      return Math.floor(diffTime / (1000 * 60 * 60 * 24));
    }
    
    function extractTopics(event, org, profiles) {
      const topics = new Set();
      
      const eventKeywords = event.description?.toLowerCase() || '';
      if (eventKeywords.includes('budget')) topics.add('Budget & Financial Planning');
      if (eventKeywords.includes('infrastructure') || eventKeywords.includes('capital')) topics.add('Infrastructure & Capital Improvements');
      if (eventKeywords.includes('staffing') || eventKeywords.includes('teacher')) topics.add('Staffing & Human Resources');
      
      org.keyInitiatives.forEach(initiative => {
        if (initiative.toLowerCase().includes('infrastructure')) topics.add('Infrastructure & Capital Improvements');
        if (initiative.toLowerCase().includes('teacher') || initiative.toLowerCase().includes('retention')) topics.add('Staffing & Human Resources');
        if (initiative.toLowerCase().includes('after-school') || initiative.toLowerCase().includes('program')) topics.add('Program Expansion');
      });
      
      profiles.forEach(profile => {
        profile.priorities.forEach(priority => {
          if (priority.toLowerCase().includes('retention') || priority.toLowerCase().includes('compensation')) topics.add('Staffing & Human Resources');
          if (priority.toLowerCase().includes('infrastructure')) topics.add('Infrastructure & Capital Improvements');
          if (priority.toLowerCase().includes('budget') || priority.toLowerCase().includes('funding')) topics.add('Budget & Financial Planning');
          if (priority.toLowerCase().includes('program')) topics.add('Program Expansion');
        });
      });
      
      return Array.from(topics);
    }
    
    function formatInteractionHistory(interactions) {
      if (interactions.length === 0) return 'No recent interactions on record.';

      const sorted = interactions.sort((a, b) =>
        new Date(b.date).getTime() - new Date(a.date).getTime()
      );

      const recent = sorted.slice(0, 3);
      const parts = recent.map(interaction => {
        const days = daysAgo(interaction.date);
        const timeAgo = days === 0 ? 'today' : days === 1 ? 'yesterday' : `${days} days ago`;
        let summary = interaction.summary;

        // Add green pulsing dot for recent activity (< 7 days)
        let timeText = `${interaction.type} ${timeAgo}`;
        if (days < 7) {
          timeText = `<span class="inline-flex items-center gap-1"><span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>${interaction.type} ${timeAgo}</span>`;
        }

        // Highlight concern/risk phrases with yellow background
        const concernPhrases = [
          'Concerned about Q4 budget constraints',
          'budget constraints',
          'concerned about',
          'challenges',
          'concerns'
        ];

        concernPhrases.forEach(phrase => {
          const regex = new RegExp(`(${phrase.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, 'gi');
          if (summary.match(regex) && !summary.includes('bg-yellow-50')) {
            summary = summary.replace(regex, '<span class="bg-yellow-50 border-l-2 border-yellow-400 pl-2 py-0.5">$1</span>');
          }
        });

        // Highlight opportunity phrases with green background
        const opportunityPhrases = [
          'Expressed interest in exploring partnership <span class="bg-green-50 px-1 py-0.5 rounded">opportunities</span>',
          'partnership <span class="bg-green-50 px-1 py-0.5 rounded">opportunities</span>',
          'positive feedback',
          'interest in exploring',
          'opportunities'
        ];

        opportunityPhrases.forEach(phrase => {
          const regex = new RegExp(`(${phrase.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, 'gi');
          // Only highlight if not already highlighted by concern phrases
          if (summary.match(regex) && !summary.includes('bg-yellow-50') && !summary.includes('bg-green-50')) {
            summary = summary.replace(regex, '<span class="bg-green-50 px-1 py-0.5 rounded">$1</span>');
          }
        });

        return `${timeText}: ${summary}`;
      });

      return parts.join(' ');
    }
    
    function generateMemo(event, profiles, org) {
      const meetingDate = formatDate(event.datetime);
      const meetingTime = formatTime(event.datetime);
      const now = new Date();
      
      const meetingContext = `This meeting is scheduled for ${meetingDate} in ${event.location}. ` +
        `The discussion will focus on ${event.description || 'upcoming initiatives and collaboration opportunities'}. ` +
        `This is a ${event.meetingType} meeting with ${profiles.length} key attendee${profiles.length > 1 ? 's' : ''} from ${org.name}. ` +
        `Given recent developments including ${org.recentNews[0]?.headline || 'organizational initiatives'}, ` +
        `this meeting presents an opportunity to align on priorities and explore partnership <span class="bg-green-50 px-1 py-0.5 rounded">opportunities</span>.`;
      
      const attendeeBackgrounds = profiles.map(profile => {
        const recentInteractions = profile.recentInteractions
          .filter(i => daysAgo(i.date) <= 90)
          .sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());
        
        const interactionContext = formatInteractionHistory(recentInteractions);
        
        const context = `${profile.bio} ` +
          `Current priorities include: ${profile.priorities.slice(0, 3).join(', ')}. ` +
          `Recent engagement: ${interactionContext} ` +
          (profile.relationshipNotes ? `Communication preferences: ${profile.relationshipNotes}` : '');
        
        return {
          name: profile.name,
          context: context.trim()
        };
      });
      
      const keyTopics = extractTopics(event, org, profiles);
      
      const suggestedTalkingPoints = [];
      
      if (keyTopics.includes('Budget & Financial Planning')) {
        const latestNews = org.recentNews.find(n => 
          n.headline.toLowerCase().includes('budget') || 
          n.headline.toLowerCase().includes('funding')
        );
        if (latestNews) {
          suggestedTalkingPoints.push(
            `Reference the ${latestNews.headline} (${latestNews.source}, ${formatDateShort(latestNews.date)}). ` +
            `Discuss how the proposed $50M infrastructure plan aligns with city priorities and explore <span class="bg-green-50 px-1 py-0.5 rounded">partnership <span class="bg-green-50 px-1 py-0.5 rounded">opportunities</span></span>.`
          );
        } else {
          const cfo = profiles.find(p => p.title.includes('CFO'));
          const days = cfo?.recentInteractions[0]?.date ? daysAgo(cfo.recentInteractions[0].date) : 0;
          suggestedTalkingPoints.push(
            `Address <span class="bg-yellow-50 border-l-2 border-yellow-400 pl-2 py-0.5">Q4 budget constraints</span> mentioned by CFO Rodriguez in recent email (${days} days ago). ` +
            `Discuss multi-year planning approach to provide budget certainty.`
          );
        }
      }
      
      if (keyTopics.includes('Infrastructure & Capital Improvements')) {
        const infraNews = org.recentNews.find(n => n.headline.toLowerCase().includes('infrastructure'));
        if (infraNews) {
          suggestedTalkingPoints.push(
            `Discuss the $50M infrastructure improvement plan announced on ${formatDateShort(infraNews.date)}. ` +
            `Explore how city resources can support the 15 schools identified, particularly focusing on HVAC systems and accessibility improvements.`
          );
        }
      }
      
      if (keyTopics.includes('Staffing & Human Resources')) {
        const retentionNews = org.recentNews.find(n => 
          n.headline.toLowerCase().includes('teacher') || 
          n.headline.toLowerCase().includes('retention')
        );
        if (retentionNews) {
          suggestedTalkingPoints.push(
            `Acknowledge the positive teacher retention results (8% improvement) mentioned in recent news. ` +
            `Discuss how city can continue supporting compensation initiatives and explore additional partnership <span class="bg-green-50 px-1 py-0.5 rounded">opportunities</span>.`
          );
        }
        
        const drJohnson = profiles.find(p => p.name.includes('Johnson'));
        if (drJohnson && drJohnson.priorities.some(p => p.toLowerCase().includes('retention'))) {
          const days = drJohnson.recentInteractions[0]?.date ? daysAgo(drJohnson.recentInteractions[0].date) : 0;
          suggestedTalkingPoints.push(
            `Dr. Johnson has prioritized teacher retention and compensation. ` +
            `Reference her previous interest in partnership <span class="bg-green-50 px-1 py-0.5 rounded">opportunities</span> (from ${days} days ago) and discuss concrete next steps.`
          );
        }
      }
      
      if (keyTopics.includes('Program Expansion')) {
        const programNews = org.recentNews.find(n => 
          n.headline.toLowerCase().includes('after-school') || 
          n.headline.toLowerCase().includes('program')
        );
        if (programNews) {
          suggestedTalkingPoints.push(
            `Address the proposal for expanded after-school programs to 20 additional schools. ` +
            `Discuss partnership <span class="bg-green-50 px-1 py-0.5 rounded">opportunities</span> with city recreation centers and explore funding mechanisms for underserved neighborhoods.`
          );
        }
      }
      
      suggestedTalkingPoints.push(
        `Acknowledge the collaborative relationship and positive outcomes from recent initiatives. ` +
        `Express commitment to continued partnership and ask about priorities for the coming year.`
      );
      
      const recentDevelopments = org.recentNews.slice(0, 3).map(news => ({
        topic: news.headline,
        detail: `${news.summary} (Source: ${news.source}, ${formatDateShort(news.date)})`
      }));
      
      const relationshipHistory = `The relationship with ${org.name} is characterized as a ${org.relationship} relationship. ` +
        `Recent interactions have been positive, with ${profiles.length} key contact${profiles.length > 1 ? 's' : ''} engaged in regular communication. ` +
        `The organization has been responsive to city initiatives and has shown interest in expanded partnership <span class="bg-green-50 px-1 py-0.5 rounded">opportunities</span>. ` +
        `Communication patterns suggest preference for detailed, data-driven discussions with advance preparation.`;
      
      const hasRecentInteractions = profiles.every(p => 
        p.recentInteractions.some(i => daysAgo(i.date) <= 60)
      );
      const hasRecentNews = org.recentNews.some(n => daysAgo(n.date) <= 30);
      const hasCompleteProfiles = profiles.every(p => 
        p.bio && p.priorities.length > 0 && p.recentInteractions.length > 0
      );
      
      let confidence = 'medium';
      if (hasRecentInteractions && hasRecentNews && hasCompleteProfiles) {
        confidence = 'high';
      } else if (!hasRecentInteractions && !hasRecentNews) {
        confidence = 'low';
      }
      
      return {
        meetingTitle: event.title,
        date: meetingTime,
        fullDate: meetingDate,
        location: event.location,
        sections: {
          meetingContext,
          attendeeBackgrounds,
          keyTopics,
          suggestedTalkingPoints,
          recentDevelopments,
          relationshipHistory
        },
        metadata: {
          generatedAt: formatDate(now.toISOString()),
          dataSources: [
            'Event calendar',
            'Contact profiles',
            'Organization database',
            'News aggregator',
            'Interaction history'
          ],
          confidence
        }
      };
    }
    
    // ============================================================================
    // UI LOGIC
    // ============================================================================
    
    let currentScreen = 1;
    let generatedMemo = null;
    
    function renderMemo() {
      if (!generatedMemo) {
        console.warn('renderMemo called but no memo generated yet');
        return;
      }
      
      const memo = generatedMemo;
      const screen3 = document.getElementById('screen3');
      
      if (!screen3) {
        console.error('Screen 3 element not found');
        return;
      }
      
      // Update title and date
      const titleEl = screen3.querySelector('h1');
      if (titleEl) titleEl.textContent = memo.meetingTitle;
      
      const dateEl = screen3.querySelector('.text-gray-600.mb-8');
      if (dateEl) {
        dateEl.innerHTML = `<p>${memo.date}</p><p>${memo.location}</p>`;
      }
      
      // Update meeting context
      const contextEl = screen3.querySelector('.bg-blue-50 p.text-gray-700');
      if (contextEl) contextEl.textContent = memo.sections.meetingContext;
      
      // Update attendee backgrounds
      const attendeeContainer = screen3.querySelector('#attendee-backgrounds');
      if (attendeeContainer) {
        attendeeContainer.innerHTML = memo.sections.attendeeBackgrounds.map((attendee, idx) => `
          <div class="border-l-4 border-purple-500 bg-purple-50/30 rounded-r-lg p-6 ${idx < memo.sections.attendeeBackgrounds.length - 1 ? 'mb-4' : ''}">
            <h3 class="text-lg font-semibold text-gray-900 mb-2">${attendee.name}</h3>
            <p class="text-gray-700 leading-relaxed">${attendee.context}</p>
          </div>
        `).join('');
      }
      
      // Update key topics
      const topicsContainer = screen3.querySelector('#key-topics');
      if (topicsContainer) {
        topicsContainer.innerHTML = memo.sections.keyTopics.map(topic => `
          <li class="flex items-center">
            <svg class="w-5 h-5 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
            </svg>
            <span class="text-gray-700">${topic}</span>
          </li>
        `).join('');
      }
      
      // Update talking points
      const talkingPointsContainer = screen3.querySelector('#talking-points');
      if (talkingPointsContainer) {
        talkingPointsContainer.innerHTML = memo.sections.suggestedTalkingPoints.map((point, idx) => `
          <div class="bg-amber-50 border-l-4 border-amber-400 rounded-r-lg p-5">
            <div class="flex items-start">
              <div class="w-8 h-8 bg-amber-400 rounded-full flex items-center justify-center text-white font-bold mr-4 flex-shrink-0">${idx + 1}</div>
              <p class="text-gray-800 leading-relaxed">${point}</p>
            </div>
          </div>
        `).join('');
      }
      
      // Update recent developments
      const developmentsContainer = screen3.querySelector('#recent-developments');
      if (developmentsContainer) {
        developmentsContainer.innerHTML = memo.sections.recentDevelopments.map(dev => {
          const newsItem = mockOrganization.recentNews.find(n => n.headline === dev.topic);
          return `
            <div class="border border-gray-200 rounded-lg p-5 hover:shadow-md transition-shadow">
              <div class="flex items-start justify-between mb-2">
                <div class="flex-1">
                  <div class="flex items-center gap-2 mb-1">
                    <h3 class="text-lg font-semibold text-gray-900">${dev.topic}</h3>
                    <span class="text-xs px-2 py-1 bg-blue-100 text-blue-800 rounded-full font-semibold flex items-center gap-1">
                      <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                      </svg>
                      Verified
                    </span>
                  </div>
                </div>
                <span class="px-2 py-1 bg-gray-100 text-gray-600 text-xs font-medium rounded ml-2">${dateStr}</span>
              </div>
              <p class="text-gray-700 leading-relaxed">${dev.detail}</p>
            </div>
          `;
        }).join('');
      }
      
      // Update relationship history
      const relationshipHistoryEl = screen3.querySelector('#relationship-history p');
      if (relationshipHistoryEl && memo.sections.relationshipHistory) {
        relationshipHistoryEl.textContent = memo.sections.relationshipHistory;
      }
      
      // Update metadata
      const dataSourcesEl = screen3.querySelector('#data-sources');
      if (dataSourcesEl) {
        dataSourcesEl.textContent = memo.metadata.dataSources.join(', ');
      }

      const lastUpdatedEl = screen3.querySelector('#last-updated');
      if (lastUpdatedEl) {
        const now = new Date();
        const timeStr = now.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true });
        const dateStr = now.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
        lastUpdatedEl.textContent = `${dateStr} at ${timeStr}`;
      }

      const confidenceEl = screen3.querySelector('#confidence');
      if (confidenceEl) {
        const confidenceText = memo.metadata.confidence.charAt(0).toUpperCase() + memo.metadata.confidence.slice(1) + ' Confidence';
        const bgColor = memo.metadata.confidence === 'high' ? 'bg-green-100 text-green-800' :
                        memo.metadata.confidence === 'medium' ? 'bg-yellow-100 text-yellow-800' :
                        'bg-red-100 text-red-800';
        confidenceEl.className = `px-3 py-1 ${bgColor} text-xs font-semibold rounded-full`;
        confidenceEl.textContent = confidenceText;
      }
    }
    
    document.addEventListener('click', (e) => {
      if (e.target.tagName === 'BUTTON' || e.target.closest('button')) {
        return;
      }
      
      if (currentScreen < 3) {
        document.getElementById(`screen${currentScreen}`).classList.remove('active');
        currentScreen++;
        
        // Generate memo when transitioning from screen 1 to screen 2
        if (currentScreen === 2 && !generatedMemo) {
          generatedMemo = generateMemo(mockEvent, mockProfiles, mockOrganization);
        }
        
        if (currentScreen === 2) {
          document.getElementById(`screen${currentScreen}`).classList.add('active');
          setTimeout(() => {
            if (currentScreen === 2) {
              document.getElementById(`screen${currentScreen}`).classList.remove('active');
              currentScreen = 3;
              // Ensure memo is generated before rendering
              if (!generatedMemo) {
                generatedMemo = generateMemo(mockEvent, mockProfiles, mockOrganization);
              }
              document.getElementById(`screen${currentScreen}`).classList.add('active');
              renderMemo();
            }
          }, 3000);
        } else if (currentScreen === 3) {
          // If jumping directly to screen 3, generate memo and render first
          if (!generatedMemo) {
            generatedMemo = generateMemo(mockEvent, mockProfiles, mockOrganization);
          }
          document.getElementById(`screen${currentScreen}`).classList.add('active');
          renderMemo();
        } else {
          document.getElementById(`screen${currentScreen}`).classList.add('active');
        }
      }
    });
    
    document.querySelector('#screen1 button').addEventListener('click', (e) => {
      e.stopPropagation();
      document.getElementById('screen1').classList.remove('active');
      currentScreen = 2;
      document.getElementById('screen2').classList.add('active');
      
      // Generate memo
      generatedMemo = generateMemo(mockEvent, mockProfiles, mockOrganization);
      
      setTimeout(() => {
        if (currentScreen === 2) {
          document.getElementById('screen2').classList.remove('active');
          currentScreen = 3;
          document.getElementById('screen3').classList.add('active');
          renderMemo();
        }
      }, 3000);
    });
    
    // Initialize Screen 1 with event data
    function initScreen1() {
      const formattedDateTime = formatTime(mockEvent.datetime);
      document.getElementById('event-title').textContent = mockEvent.title;
      document.getElementById('event-datetime').textContent = formattedDateTime;
      document.getElementById('event-location').textContent = mockEvent.location;
    }
    
    // Initialize on page load
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initScreen1);
    } else {
      initScreen1();
    }
  </script>
</body>
</html>